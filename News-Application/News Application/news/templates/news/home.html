{% extends 'news/base.html' %}

{% block title %}Home - News Application{% endblock %}

{% block content %}
{% if not user.is_authenticated %}
<div class="welcome-section">
    <h1>Welcome to News App</h1>
    <p>Stay informed with the latest news, create content, and connect with publishers</p>
    <div class="auth-links">
        <a href="{% url 'news:login' %}" class="btn btn-primary">Login</a>
    </div>
    <div class="auth-links" style="margin-top: 1rem;">
        <a href="{% url 'news:register' %}" class="btn btn-success">Individual Account</a>
        <a href="{% url 'news:register_publisher' %}" class="btn" style="background: #ff6b35; color: white;">Publishing House</a>
    </div>
</div>

<div class="feature-highlight">
    <div class="feature-card">
        <span class="feature-icon">📰</span>
        <h3>Read News</h3>
        <p>Access latest articles from trusted sources</p>
    </div>
    <div class="feature-card">
        <span class="feature-icon">✍️</span>
        <h3>Create Content</h3>
        <p>Write and publish your own articles</p>
    </div>
    <div class="feature-card">
        <span class="feature-icon">🏢</span>
        <h3>Publishing House</h3>
        <p>Manage your media organization</p>
    </div>
</div>
{% else %}
<h1>Latest News Articles</h1>
{% endif %}

<div class="search-form">
    <form method="get" action="{% url 'news:search_articles' %}">
        <div class="form-group">
            <input type="text" name="q" class="form-control" placeholder="Search articles..." value="{{ query }}">
        </div>
        <div class="form-group">
            <select name="category" class="form-control">
                <option value="">All Categories</option>
                {% for category in categories %}
                    <option value="{{ category.name }}">{{ category.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <select name="publisher" class="form-control">
                <option value="">All Publishers</option>
                {% for publisher in publishers %}
                    <option value="{{ publisher.name }}">{{ publisher.name }}</option>
                {% endfor %}
            </select>
        </div>
        <button type="submit" class="btn btn-primary">Search</button>
    </form>
</div>

{% if page_obj %}
    {% for article in page_obj %}
        <div class="article-card">
            <h2 class="article-title">
                <a href="{% url 'news:article_detail' article.pk %}">{{ article.title }}</a>
            </h2>
            <div class="article-meta">
                <span>👤 {{ article.author.username }}</span>
                {% if article.publisher %}
                    <span>🏢 {{ article.publisher.name }}</span>
                {% endif %}
                {% if article.category %}
                    <span>📂 {{ article.category.name }}</span>
                {% endif %}
                <span>📅 {{ article.created_at|date:"M d, Y" }}</span>
            </div>
            {% if article.summary %}
                <p class="article-summary">{{ article.summary }}</p>
            {% endif %}
        </div>
    {% endfor %}

    {% if page_obj.has_other_pages %}
        <div class="pagination">
            {% if page_obj.has_previous %}
                <a href="?page=1">&laquo; First</a>
                <a href="?page={{ page_obj.previous_page_number }}">Previous</a>
            {% endif %}

            <span class="current">
                Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
            </span>

            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}">Next</a>
                <a href="?page={{ page_obj.paginator.num_pages }}">Last &raquo;</a>
            {% endif %}
        </div>
    {% endif %}
{% else %}
    <p>No articles found.</p>
{% endif %}
{% endblock %}
